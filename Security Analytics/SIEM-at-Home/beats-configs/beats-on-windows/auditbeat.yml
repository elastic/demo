# Example for the Beats on Windows blog
# Configuration version: 12-06-2019
#=== Auditbeat specific options ===
#===  Modules configuration ===
auditbeat.modules:

- module: file_integrity
  paths:
  - C:/windows
  - C:/windows/system32
  - C:/windows/SysWOW64
  - C:/Program Files
  - C:/Program Files (x86)
  - C:/ProgramData
  - C:/autoexec.bat
  - C:/boot.ini
  - C:/config.sys
  - C:/windows/system.ini
  - C:/windows/win.ini
  - C:/windows/regedit.exe
  - C:/windows/System32/userinit.exe
  - C:/windows/explorer.exe
  - C:/ProgramFiles/Microsoft Security Client/msseces.exe
  - HKLM/SOFTWARE/Microsoft/Cryptography/OID/EncodingType 0/CryptSIPDllRemoveSignedDataMsg{C689AAB8-8E78-11D0-8C47-00C04FC295EE}
  - HKLM/SOFTWARE/Microsoft/Cryptography/OID/EncodingType 0/CryptSIPDllRemoveSignedDataMsg{603BCC1F-4B59-4E08-B724-D2C6297EF351}
  - HKLM/SOFTWARE/Microsoft/Windows NT/CurrentVersion/IniFileMapping/SYSTEM.ini/boot
  - HKLM/SOFTWARE/Microsoft/Windows NT/CurrentVersion/Windows
  - HKLM/SOFTWARE/Microsoft/Windows NT/CurrentVersion/Winlogon
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/Shell Folders
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/User Shell Folders
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/Run
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/RunOnce
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/RunOnceEx
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/RunServices
  - HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/RunServicesOnce
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Cryptography/OID/EncodingType 0/CryptSIPDllRemoveSignedDataMsg{C689AAB8-8E78-11D0-8C47-00C04FC295EE}
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Cryptography/OID/EncodingType 0/CryptSIPDllRemoveSignedDataMsg{603BCC1F-4B59-4E08-B724-D2C6297EF351}
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows NT/CurrentVersion/IniFileMapping/system.ini/boot
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows NT/CurrentVersion/Windows
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows NT/CurrentVersion/Winlogon
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/Explorer/Shell Folders
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/Explorer/User Shell Folders
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/Run
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/RunOnce
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/RunOnceEx
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/RunServices
  - HKLM/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/RunServicesOnce
  - HKLM/SYSTEM/CurrentControlSet/Control/hivelist
  - HKLM/SYSTEM/CurrentControlSet/Control/Session Manager/KnownDLLs
  - HKLM/SYSTEM/CurrentControlSet/Services/SharedAccess/Parameters/FirewallPolicy/DomainProfile
  - HKLM/SYSTEM/CurrentControlSet/Services/SharedAccess/Parameters/FirewallPolicy/PublicProfile
  - HKLM/SYSTEM/CurrentControlSet/Services/SharedAccess/Parameters/FirewallPolicy/StandardProfile

- module: system
  datasets:
    - host
  state.period: 12h
  period: 1m

- module: system
  datasets:
    - process
  processors:
    - add_process_metadata:
        match_pids: [process.ppid]
        target: system.process.parent
  period: 1s

#=== Auditbeat logging ===
# Configure logging for Auditbeat if you plan on using the GeoIP ingest processor
# Initially use `info` for the logging.level, set logging.level to `debug` if you see
# an `Failed to publish events: temporary bulk send failure` error message in the logs
#logging.level: info
#logging.to_files: true
#logging.files:
#  path: C:\Program Files\Elastic\logs\
#  name: auditbeat
#  keepfiles: 7
#  permissions: 0644

#=== Beats Common Configs Here ===
# Add the settings from the Beats General Config file (beats-general-config.yml)
# to the end of this configuration file. The Beats General Config file example can be found at this link:
# https://github.com/elastic/examples/blob/master/Security%20Analytics/SIEM-at-Home/beats-configs/beats-general-config.yml
